<div style="max-width: 900px; margin: 2rem auto">
  <form
    (ngSubmit)="onSearch()"
    style="
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      width: 100%;
    "
  >
    <mat-form-field
      appearance="outline"
      color="primary"
      style="
        width: 100%;
        background: #fff;
        border-radius: 6px;
        box-shadow: 0 2px 8px #0001;
      "
    >
      <mat-label>Search inventory</mat-label>
      <input
        matInput
        [(ngModel)]="searchQuery"
        name="searchQuery"
        (keyup.enter)="onSearch()"
        placeholder="Search by name, type, location..."
        style="
          color: #222;
          font-size: 1.08rem;
          background: transparent;
          border-radius: 6px;
          width: 100%;
        "
        autocomplete="off"
      />
      <button
        mat-icon-button
        matSuffix
        *ngIf="searchQuery"
        (click)="clearSearch()"
        tabindex="-1"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <button mat-icon-button color="primary" type="submit" aria-label="Search">
      <mat-icon>search</mat-icon>
    </button>
  </form>
  <!-- Search result banner moved below form -->
  <div
    *ngIf="isSearchActive"
    style="margin-bottom: 1rem; display: flex; align-items: center"
  >
    <mat-icon color="primary" style="vertical-align: middle">search</mat-icon>
    <span style="font-weight: 500; color: #1976d2; margin-left: 0.25rem"
      >Search results for:</span
    >
    <span style="font-style: italic; color: #333; margin-left: 0.25rem"
      >"{{ searchQuery }}"</span
    >
    <button
      mat-button
      color="primary"
      (click)="clearSearch()"
      style="margin-left: 0.5rem"
    >
      Clear
    </button>
  </div>
  <mat-card>
    <mat-card-title>Inventory List</mat-card-title>
    <!-- Type selector removed -->

    <table
      mat-table
      [dataSource]="pagedItems"
      style="width: 100%; margin-bottom: 1rem"
      *ngIf="items.length; else loading"
    >
      <ng-container matColumnDef="icon">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let item">
          <mat-icon>
            {{ item.type === 'tool' ? 'build' : 'settings' }}
          </mat-icon>
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let item">
          <a [routerLink]="['/inventory', item.id]" class="material-link">
            <span>{{ item.name }}</span>
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let item">{{ item.type }}</td>
      </ng-container>

      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef>Qty</th>
        <td mat-cell *matCellDef="let item">{{ item.quantity }}</td>
      </ng-container>

      <ng-container matColumnDef="location">
        <th mat-header-cell *matHeaderCellDef>Location</th>
        <td mat-cell *matCellDef="let item">{{ item.location }}</td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Price</th>
        <td mat-cell *matCellDef="let item">${{ item.price }}</td>
      </ng-container>

      <ng-container matColumnDef="addToCart">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let item">
          <button
            mat-raised-button
            color="accent"
            (click)="addToCart(item)"
            style="margin-left: 8px"
            [disabled]="item.quantity === 0"
          >
            Add to Cart
          </button>
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="
          ['icon', 'name', 'type', 'quantity', 'location', 'price', 'addToCart']
        "
      ></tr>
      <tr
        mat-row
        *matRowDef="
          let row;
          columns: ['icon', 'name', 'type', 'quantity', 'location', 'price', 'addToCart']
        "
      ></tr>
    </table>
    <mat-paginator
      [length]="items.length"
      [pageSize]="pageSize"
      [pageSizeOptions]="[15, 30, 50]"
      (page)="onPageChange($event)"
      showFirstLastButtons
    ></mat-paginator>

    <ng-template #loading>
      <div style="display: flex; justify-content: center; padding: 2rem">
        <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
      </div>
    </ng-template>
  </mat-card>
</div>

<style>
  .material-link {
    color: inherit;
    text-decoration: none;
    font-weight: 500;
    border-bottom: 1px dashed #888;
    transition: border-bottom-color 0.2s;
  }
  .material-link:hover {
    border-bottom-color: #1976d2;
    color: #1976d2;
  }
</style>
